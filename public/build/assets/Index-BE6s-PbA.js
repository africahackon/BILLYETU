import{r as m,u as D,i as u,o as i,b as g,d as e,e as l,h as M,k as p,v as y,x as $,M as x,F as f,m as k,t as d,l as w,z as v,a as A,g as E,y as j}from"./app-B-oWgorL.js";import{_ as N}from"./Modal-rL_D16Y4.js";const q={class:"p-6 space-y-4"},B={class:"flex justify-between items-center"},F=["href"],I={class:"flex gap-4 mb-4"},K={class:"w-full text-left border mt-4 bg-white shadow rounded"},O={class:"px-4 py-2"},R={class:"px-4 py-2"},T={class:"px-4 py-2"},z={class:"px-4 py-2"},L={class:"px-4 py-2"},Y={class:"px-4 py-2"},G={class:"px-4 py-2 space-x-2"},H=["onClick"],J=["onClick"],Q={class:"mt-4 flex justify-between"},W={class:"text-lg font-semibold"},X=["value"],Z={class:"flex items-center space-x-2"},ee={class:"flex justify-end space-x-2"},te={type:"submit",class:"bg-blue-600 text-white px-4 py-2 rounded"},le={__name:"Index",props:{payments:Object,filters:Object,users:Array},setup(c){const a=m(!1),b=m(!1),h=m(null);m("");const n=D({user_id:"",receipt_number:"",checked:!1,paid_at:"",disbursement_type:""});function C(){n.reset(),b.value=!1,a.value=!0}function P(o){h.value=o.id,n.user_id=users.find(t=>t.username===o.user)?.id||"",n.receipt_number=o.receipt_number,n.checked=o.checked,n.paid_at=o.paid_at,n.disbursement_type=o.disbursement_type||"",b.value=!0,a.value=!0}const r=m({search:r.search||"",disbursement:r.disbursement||""});function U(){b.value?n.put(route("tenants.payments.update",h.value),{onSuccess:()=>a.value=!1}):n.post(route("tenants.payments.store"),{onSuccess:()=>a.value=!1})}function V(o){confirm("Delete this payment?")&&v.delete(route("tenants.payments.destroy",o))}function _(){v.get(route("tenants.payments.index"),{search:r.value.search,disbursement:r.value.disbursement},{preserveState:!0})}return(o,t)=>(i(),u(f,null,[g(l(M),{title:"Tenant Payments"}),e("div",q,[e("div",B,[t[11]||(t[11]=e("h1",{class:"text-2xl font-bold"},"Payments",-1)),e("a",{href:o.route("tenants.payments.export"),class:"bg-green-600 text-white px-4 py-2 rounded"},"Export Excel",8,F),e("button",{onClick:C,class:"bg-blue-600 text-white px-4 py-2 rounded"},"Add Payment")]),e("div",I,[p(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>r.value.search=s),onKeyup:$(_,["enter"]),placeholder:"Search by user or phone",class:"border p-2 rounded w-full max-w-md"},null,544),[[y,r.value.search]]),p(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>r.value.disbursement=s),onChange:_,class:"border p-2 rounded"},[...t[12]||(t[12]=[e("option",{value:""},"All",-1),e("option",{value:"direct"},"Direct",-1),e("option",{value:"paid"},"Paid",-1),e("option",{value:"pending"},"Pending",-1)])],544),[[x,r.value.disbursement]])]),e("table",K,[t[13]||(t[13]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"px-4 py-2"},"User"),e("th",{class:"px-4 py-2"},"Phone"),e("th",{class:"px-4 py-2"},"Receipt"),e("th",{class:"px-4 py-2"},"Checked"),e("th",{class:"px-4 py-2"},"Paid At"),e("th",{class:"px-4 py-2"},"Disbursement"),e("th",{class:"px-4 py-2"},"Actions")])],-1)),e("tbody",null,[(i(!0),u(f,null,k(c.payments.data,s=>(i(),u("tr",{key:s.id,class:"border-t"},[e("td",O,d(s.user),1),e("td",R,d(s.phone),1),e("td",T,d(s.receipt_number),1),e("td",z,d(s.checked?"Yes":"No"),1),e("td",L,d(s.paid_at),1),e("td",Y,d(s.disbursement),1),e("td",G,[e("button",{onClick:S=>P(s),class:"text-blue-600 hover:underline"},"Edit",8,H),e("button",{onClick:S=>V(s.id),class:"text-red-600 hover:underline"},"Delete",8,J)])]))),128))])]),e("div",Q,[c.payments.prev_page_url?(i(),u("button",{key:0,onClick:t[2]||(t[2]=s=>l(v).get(c.payments.prev_page_url)),class:"px-4 py-2 bg-gray-200 rounded"},"Previous")):w("",!0),c.payments.next_page_url?(i(),u("button",{key:1,onClick:t[3]||(t[3]=s=>l(v).get(c.payments.next_page_url)),class:"px-4 py-2 bg-gray-200 rounded"},"Next")):w("",!0)])]),g(N,{show:a.value,onClose:t[10]||(t[10]=s=>a.value=!1)},{default:A(()=>[e("form",{onSubmit:E(U,["prevent"]),class:"p-6 space-y-4"},[e("h2",W,d(b.value?"Edit":"Add")+" Payment",1),p(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>l(n).user_id=s),class:"w-full border p-2 rounded",required:""},[t[14]||(t[14]=e("option",{value:""},"Select User",-1)),(i(!0),u(f,null,k(c.users,s=>(i(),u("option",{key:s.id,value:s.id},d(s.username),9,X))),128))],512),[[x,l(n).user_id]]),p(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l(n).receipt_number=s),placeholder:"Receipt #",class:"w-full border p-2 rounded",required:""},null,512),[[y,l(n).receipt_number]]),p(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l(n).paid_at=s),type:"datetime-local",class:"w-full border p-2 rounded",required:""},null,512),[[y,l(n).paid_at]]),p(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>l(n).disbursement_type=s),class:"w-full border p-2 rounded"},[...t[15]||(t[15]=[e("option",{value:""},"Pending",-1),e("option",{value:"direct"},"Direct",-1),e("option",{value:"paid"},"Paid",-1)])],512),[[x,l(n).disbursement_type]]),e("label",Z,[p(e("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=s=>l(n).checked=s)},null,512),[[j,l(n).checked]]),t[16]||(t[16]=e("span",null,"Checked",-1))]),e("div",ee,[e("button",{type:"button",onClick:t[9]||(t[9]=s=>a.value=!1),class:"px-4 py-2 border rounded"},"Cancel"),e("button",te,d(b.value?"Update":"Save"),1)])],32)]),_:1},8,["show"])],64))}};export{le as default};
